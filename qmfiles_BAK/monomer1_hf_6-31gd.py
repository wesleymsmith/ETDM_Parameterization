#!/usr/bin/env python
import psi4,os,importlib
import numpy as np
mem="1000mb"
cpu=4
psi4.set_num_threads(cpu)
psi4.set_memory(mem)

psi4.core.set_output_file(os.path.dirname(os.path.abspath(__file__))+'/'+'.'.join(os.path.basename(__file__).split('.')[:-1])+'.out', False)




opttheory="hf"
optbasis="6-31g*"
options={'scf_type': 'df', 'g_convergence':'gau','freeze_core':'true'}
psi4.set_options(options)


psi4_xyz="""
1 1
N    	-0.558511	-1.104298	0.059242
N    	-5.332115	-1.264133	0.946425
N    	2.987014	3.742732	-0.859926
C    	0.589667	-0.431177	-0.148542
C    	-1.793396	-0.459422	0.213055
C    	0.602404	0.987790	-0.222931
C    	-1.823043	0.963713	0.171674
C    	-0.635838	1.695565	-0.138453
C    	-0.517819	-2.591495	0.138850
C    	1.858834	-1.182520	-0.277191
C    	-2.961359	-1.201761	0.487625
C    	1.814780	1.665617	-0.475308
C    	-3.090438	1.583481	0.320192
C    	-0.584238	3.106373	-0.237916
C    	-4.187998	-0.562051	0.628870
C    	1.834251	3.056271	-0.571465
C    	-0.499750	-3.074968	1.581835
C    	-4.225724	0.855810	0.580896
C    	0.601464	3.761085	-0.485806
C    	2.635178	-1.441881	0.862393
C    	2.316986	-1.566238	-1.547332
C    	3.853106	-2.111609	0.730111
C    	3.533500	-2.239665	-1.667547
C    	4.299885	-2.514457	-0.531191
H    	-1.375868	-2.962670	-0.422091
H    	0.377293	-2.911734	-0.389713
H    	-2.943784	-2.282196	0.558506
H    	2.742516	1.105695	-0.549603
H    	-3.167058	2.665052	0.295715
H    	-1.492868	3.696834	-0.183982
H    	0.428445	-2.768850	2.067656
H    	-0.545574	-4.167728	1.593761
H    	-1.342016	-2.685968	2.156734
H    	-5.176610	1.368201	0.711615
H    	0.605186	4.845623	-0.580552
H    	2.295934	-1.105080	1.840182
H    	1.722430	-1.339438	-2.430496
H    	4.455197	-2.314157	1.612078
H    	3.886444	-2.542856	-2.649792
H    	-6.213892	-0.802802	0.756387
H    	-5.348181	-2.249508	0.711108
H    	3.866994	3.271442	-0.690528
H    	3.009059	4.731922	-0.646183
H    	5.247709	-3.036741	-0.629565

"""
mol=psi4.geometry(psi4_xyz)
mol.update_geometry() # This update is required for psi4 to load the molecule
E=psi4.energy(opttheory+"/"+optbasis)
psi4.core.print_out('INTERACTION MONOMER ENERGY is : '+str(E) )