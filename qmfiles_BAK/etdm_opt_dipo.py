#!/usr/bin/env python
import psi4,os,importlib
import numpy as np
mem="1000mb"
cpu=4
psi4.set_num_threads(cpu)
psi4.set_memory(mem)

psi4.core.set_output_file(os.path.dirname(os.path.abspath(__file__))+'/'+'.'.join(os.path.basename(__file__).split('.')[:-1])+'.out', False)


psi4_xyz="""
1 1
N    	-0.422000	-1.059600	-0.106700
N    	-5.097300	-2.128500	-0.156800
N    	2.531700	4.220000	0.129900
C    	0.627800	-0.235700	-0.069100
C    	-1.697100	-0.636500	-0.089000
C    	0.451600	1.140800	-0.008100
C    	-1.968200	0.751100	-0.027500
C    	-0.862000	1.663200	0.014100
C    	-0.152000	-2.514600	-0.170200
C    	1.926500	-0.883900	-0.097900
C    	-2.731100	-1.584000	-0.132000
C    	1.567300	1.993200	0.030800
C    	-3.333300	1.128000	-0.011900
C    	-0.988700	3.072600	0.076800
C    	-4.059800	-1.174700	-0.114900
C    	1.404900	3.373900	0.092100
C    	-0.061000	-3.072800	1.235900
C    	-4.361100	0.180100	-0.055000
C    	0.126800	3.913800	0.115300
C    	2.546200	-1.246700	1.095000
C    	2.545800	-1.139700	-1.318500
C    	3.793900	-1.869600	1.067300
C    	3.793400	-1.762700	-1.346300
C    	4.417600	-2.127700	-0.153300
H    	-0.877100	-3.038200	-0.796400
H    	0.758500	-2.742400	-0.723400
H    	-2.582800	-2.656300	-0.140200
H    	2.583300	1.604500	0.014200
H    	-3.625600	2.173900	0.034400
H    	-1.966600	3.547000	0.097200
H    	0.362000	-2.386300	1.969000
H    	0.522100	-3.999200	1.240400
H    	-1.060600	-3.325600	1.605800
H    	-5.394100	0.518900	-0.040500
H    	-0.021800	4.989700	0.163100
H    	2.093900	-1.023600	2.057700
H    	2.072500	-0.860500	-2.256800
H    	4.283400	-2.146600	1.996400
H    	4.279400	-1.963200	-2.296700
H    	-6.062500	-1.826800	-0.146100
H    	-4.878700	-3.114800	-0.202900
H    	3.462700	3.825300	0.113500
H    	2.410400	5.223000	0.175100
H    	5.389900	-2.611000	-0.175000

symmetry c1
no_reorient
no_com

"""
mol=psi4.geometry(psi4_xyz)
mol.update_geometry() # This update is required for psi4 to load the molecule


opttheory="mp2"
optbasis="6-31g*"
options={'scf_type': 'df', 'g_convergence':'gau','freeze_core':'true'}
psi4.set_options(options)


psi4.optimize(opttheory+"/"+optbasis,mol=mol)
psi4.core.print_out("Dipole START\n")
dipobasis="6-31g*"
dipotheory="mp2"
psi4.prop(dipotheory+"/"+dipobasis, properties=["DIPOLE"])
psi4.core.print_out("Dipole END\n")
